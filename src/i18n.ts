type Locale = 'en' | 'de';

type TranslationParams = Record<string, string | number>;

const TRANSLATIONS = {
    en: {
        'options.title': 'Options',
        'options.cellShape.label': 'Cell shapes',
        'options.cellShape.square': 'All squares',
        'options.cellShape.shaped': 'Color-specific shapes',
        'options.language.label': 'Language',
        'options.language.english': 'English',
        'options.language.german': 'German',
        'options.audio.label': 'Audio',
        'options.performance.label': 'Animations',
        'options.lead': 'Configure the experience to suit your play style.',
        'options.performance.high': 'Full effects',
        'options.performance.low': 'Performance mode',
        'options.audio.on': 'Audio on',
        'options.audio.off': 'Audio off',
        'options.exit': 'Exit game',
        'options.deleteProgress': 'Delete game progress',
        'options.deleteProgress.confirm': 'Do you really want to delete all your game progress?',
        'options.deleteProgress.confirmButton': 'Delete progress',
        'options.deleteProgress.cancelButton': 'Cancel',
        'options.info': 'Information',
        'options.infoLink.legal': 'Legal notice',
        'options.infoLink.privacy': 'Privacy policy',
        'mainMenu.lead': 'Welcome to',
        'mainMenu.description':
            'Combine colorful candies, trigger explosions, and beat the level targets. Jump into Level Mode, chase a new high score in Blocker Mode, or test the speeding-up Time Mode.',
        'mainMenu.note': 'High scores are stored along with your level progress. Open the options menu via the top-right button.',
        'button.levelMode': 'Level Mode',
        'button.blockerMode': 'Blocker Mode',
        'button.timeMode': 'Time Mode',
        'button.leaderboard': 'Leaderboard',
        'button.shop': 'Shop',
        'button.continue': 'Continue',
        'button.restart': 'Restart',
        'button.home': 'Home',
        'button.back': 'Back',
        'button.account': 'Account',
        'button.tutorial': 'Tutorial',
        'levelSelect.title': 'Candy World',
        'levelSelect.subtitle': 'Choose a level to replay or keep moving forward.',
        'levelSelect.selectedTitle': 'Level {level}',
        'levelSelect.meta': '{moves} moves · Target {target} points · {difficulty}',
        'levelSelect.playButton': 'Play level',
        'levelSelect.playButtonLabel': 'Play level {level}',
        'levelSelect.goalsTitle': 'Goals',
        'levelSelect.nodeLabel': 'Level {level}',
        'levelSelect.nodeLockedLabel': 'Level {level} locked',
        'difficulty.easy': 'Easy',
        'difficulty.normal': 'Normal',
        'difficulty.hard': 'Hard',
        'difficulty.expert': 'Expert',
        'difficulty.nightmare': 'Nightmare',
        'auth.label': 'Google Login',
        'auth.status.notSignedIn': 'Not signed in',
        'auth.status.signedIn': 'Signed in as {name}',
        'auth.progress.level': 'Progress: Level {level}',
        'auth.progress.blocker': 'Blocker high score: {score}',
        'auth.progress.time': 'Time mode best: {time}',
        'auth.progress.coins': 'Sugar coins: {coins}',
        'auth.progress.coins.loading': 'Sugar coins are loading...',
        'auth.progress.loading': 'Progress is loading...',
        'auth.progress.blocker.loading': 'Loading blocker high score...',
        'auth.progress.time.loading': 'Loading time mode...',
        'auth.hint': 'Sign in before playing so your progress is tied to your account.',
        'auth.googleInfo.prefix': 'By signing up via Google, you agree that your name and game progress will be processed in accordance with our',
        'auth.googleInfo.link': 'privacy policy',
        'auth.googleInfo.suffix': '.',
        'auth.loginButton': 'Sign in with Google',
        'auth.error.loginFailed': 'Login failed. Please try again.',
        'auth.error.progressLoad': 'Progress could not be loaded. Default level 1 will be used.',
        'auth.error.progressSave': 'Progress could not be saved. Please check your connection.',
        'auth.error.progressDelete': 'Progress could not be deleted. Please try again later.',
        'auth.error.accountDelete': 'Account could not be deleted. Please try again later.',
        'hud.status.ready': 'Ready for combos!',
        'hud.status.noMoves': 'No moves possible. Shuffling!',
        'hud.status.powerupCanceled': 'Powerup canceled!',
        'hud.label.time': 'Time',
        'hud.label.moves': 'Moves',
        'hud.label.goals': 'Goals',
        'hud.status.chooseAdjacent': 'Select a neighboring cell',
        'hud.status.targetAdjacent': 'Target must be adjacent',
        'hud.status.powerupActivated': '{powerup} activated!',
        'hud.status.chooseTarget': 'Choose target for {powerup}',
        'hud.status.powerupUnleashed': '{powerup} unleashed!',
        'hud.status.switchExecuted': 'Switch executed!',
        'hud.aria.remainingTime': 'Remaining time {current} of {capacity}',
        'hud.aria.scoreBlocker': 'Score {score} of {target}. Best run: {best}',
        'hud.aria.scoreNormal': 'Score {score} of {target}',
        'hud.goal.remaining': '{description} remaining: {remaining}',
        'hud.timeModeHint': 'Survived: {survived} · Best time: {best}',
        'hud.blockerHighscore': 'Highscore: {score}',
        'hud.audio.on': 'Audio on',
        'hud.audio.off': 'Audio off',
        'renderer.comboIncrease': 'Strong move!',
        'renderer.comboDecrease': 'Momentum lost!',
        'renderer.comboNeutral': 'Multiplier',
        'renderer.points': ' · +{points} points',
        'result.level.winTitle': 'Level {level} complete!',
        'result.level.loseTitle': 'Level failed!',
        'result.level.winNext': 'Next stop is Level {level}.',
        'result.level.winAll': 'You mastered all {count} levels. Keep playing the finale for high scores.',
        'result.level.loseText': 'Try again right away.',
        'result.blocker.newHighscore': 'New high score!',
        'result.blocker.gameOver': 'No moves left!',
        'result.blocker.text': 'Points: {score}. Best run: {best}. Try again?',
        'result.time.newBest': 'New best time!',
        'result.time.timeUp': "Time's up!",
        'result.time.text': 'Survived: {survived}. Best time: {best}. Try again?',
        'blocker.status.started': 'Blocker Mode started. Survive as long as possible.',
        'blocker.status.moreHardCandy': 'More hard candies appear!',
        'blocker.status.newHighscore': 'New high score!',
        'time.status.started': 'Survive as long as possible. Matches and goals reward time.',
        'time.status.goalComplete': 'Goal complete! +{seconds}s',
        'leaderboard.lead': 'Overview',
        'leaderboard.title': 'Leaderboard',
        'leaderboard.back': 'Back to menu',
        'leaderboard.mode.level': 'Level Mode',
        'leaderboard.mode.blocker': 'Blocker Mode',
        'leaderboard.mode.time': 'Time Mode',
        'leaderboard.scope.global': 'Global',
        'leaderboard.scope.personal': 'Personal',
        'leaderboard.scope.label': 'Scope',
        'leaderboard.loginRequired': 'Please sign in to see personal results.',
        'leaderboard.error.loadFailed': 'Leaderboard could not be loaded.',
        'leaderboard.loading': 'Leaderboard is loading...',
        'leaderboard.empty': 'No entries available.',
        'leaderboard.metric.level': 'Highest level',
        'leaderboard.metric.time': 'Survival time',
        'leaderboard.metric.blocker': 'Blocker score',
        'leaderboard.entry.level': 'Level {level}',
        'leaderboard.entry.points': '{points} points',
        'leaderboard.subtitle.countOne': '{count} entry',
        'leaderboard.subtitle.countOther': '{count} entries',
        'leaderboard.subtitleTemplate': '{mode} → {scope} → {countLabel}',
        'leaderboard.localPlayer': 'You',
        'account.title': 'My Account',
        'account.field.name': 'Name',
        'account.status.google': 'Google account',
        'account.status.guest': 'Guest profile',
        'account.guestDefaultName': 'Guest',
        'account.name.saveButton': 'Save name',
        'account.name.saved': 'Name saved',
        'account.name.error.empty': 'Please enter a name.',
        'account.name.error.generic': 'Changes could not be saved. Try again later.',
        'account.logoutGoogle': 'Logout from Google',
        'account.deleteAccount': 'Delete account',
        'account.deleteAccount.confirm': 'Do you really want to delete your Google account and all stored progress?',
        'account.deleteAccount.confirmButton': 'Delete account',
        'powerup.shuffle.label': 'Shuffle',
        'powerup.shuffle.description': 'Rearrange all candies',
        'powerup.switch.label': 'Switch',
        'powerup.switch.description': 'Swap two adjacent cells without a match',
        'powerup.bomb.label': 'Bomb',
        'powerup.bomb.description': 'Clear a 4×4 area of your choice',
        'shop.title': 'Sugar Shop',
        'shop.lead': 'Spend sugar coins on tactical advantages.',
        'shop.count': 'Owned: {count}/{max}',
        'shop.price': 'Price: {price} sugar coins',
        'shop.priceMaxed': 'Maxed out',
        'shop.button.buy': 'Buy',
        'shop.feedback.insufficient': 'Not enough sugar coins.',
        'shop.feedback.maxed': 'You already own every slot for this powerup.',
        'tutorial.title': 'Candy Guide',
        'tutorial.lead': 'Learn the basics of boosters, matches, and special tiles.',
        'tutorial.section.boosters': 'Boosters',
        'tutorial.section.matches': 'Matches',
        'tutorial.section.mechanics': 'Game Mechanics',
        'tutorial.section.obstacles': 'Obstacles',
        'tutorial.section.modes': 'Modes',
        'tutorial.boosters.lead': 'The shop sells three tactical powerups that can be used mid-level.',
        'tutorial.matches.lead':
            'Bombs are activated by matching the right color. There are 5 different colors and the match has to be of the same color.',
        'tutorial.matches.threeTitle': 'Match 3',
        'tutorial.matches.threeText': 'Clear the candies and score points.',
        'tutorial.matches.fourTitle': 'Match 4',
        'tutorial.matches.fourText': 'Creates a line bomb.',
        'tutorial.matches.fiveTitle': 'Match 5',
        'tutorial.matches.fiveText': 'Creates a large blast bomb. A match 5 bomb is activated by clicking on it.',
        'tutorial.matches.ltTitle': 'L or T',
        'tutorial.matches.ltText': 'Creates a medium blast bomb.',
        'tutorial.matches.squareTitle': 'Square (2x2)',
        'tutorial.matches.squareText': 'Creates a small blast bomb.',
        'tutorial.mechanics.multiplierText':
            'The score multiplier rises after strong moves, drops after weak or empty moves, and applies to every point you earn.',
        'tutorial.obstacles.hardTitle': 'Hard candies',
        'tutorial.obstacles.hardText': 'Adjacent matches crack them before they can be cleared.',
        'tutorial.obstacles.chestTitle': 'Sugar chests',
        'tutorial.obstacles.chestText':
            'Adjacent matches crack them until they burst into sugar coins. It takes 4 adjacent matches to break a chest.',
        'tutorial.obstacles.generatorTitle': 'Blocker generators',
        'tutorial.obstacles.generatorText': 'Every few matches they create new hard candies nearby.',
        'tutorial.modes.levelTitle': 'Level Mode',
        'tutorial.modes.levelText':
            'Finish goals with limited moves. Difficulties: Easy, Normal, Hard, Expert, Nightmare.',
        'tutorial.modes.blockerTitle': 'Blocker Mode',
        'tutorial.modes.blockerText': 'Survive as hard candies spread and chase a high score.',
        'tutorial.modes.timeTitle': 'Time Mode',
        'tutorial.modes.timeText': 'Beat the clock as it speeds up; matches add time.',
        'goal.destroyColor': 'Destroy {target} {color} tiles',
        'goal.activateBooster': 'Activate {target} {booster}',
        'color.red': 'red',
        'color.amber': 'amber',
        'color.blue': 'blue',
        'color.purple': 'purple',
        'color.green': 'green',
        'booster.LINE': 'line bombs',
        'booster.BURST_SMALL': 'small bombs',
        'booster.BURST_MEDIUM': 'medium bombs',
        'booster.BURST_LARGE': 'large bombs'
    },
    de: {
        'options.title': 'Optionen',
        'options.cellShape.label': 'Zellformen',
        'options.cellShape.square': 'Alle Quadrate',
        'options.cellShape.shaped': 'Farb-spezifische Formen',
        'options.language.label': 'Sprache',
        'options.language.english': 'Englisch',
        'options.language.german': 'Deutsch',
        'options.audio.label': 'Audio',
        'options.performance.label': 'Animationen',
        'options.lead': 'Passe das Erlebnis deinem Stil an.',
        'options.performance.high': 'Volle Effekte',
        'options.performance.low': 'Performance-Modus',
        'options.audio.on': 'Audio an',
        'options.audio.off': 'Audio aus',
        'options.exit': 'Spiel beenden',
        'options.deleteProgress': 'Spielstand löschen',
        'options.deleteProgress.confirm': 'Möchtest du wirklich deinen gesamten Spielstand löschen?',
        'options.deleteProgress.confirmButton': 'Spielstand löschen',
        'options.deleteProgress.cancelButton': 'Abbrechen',
        'options.info': 'Info',
        'options.infoLink.legal': 'Impressum',
        'options.infoLink.privacy': 'Datenschutzerklärung',
        'mainMenu.lead': 'Willkommen zu',
        'mainMenu.description':
            'Kombiniere farbige Süßigkeiten, löse Explosionen aus und knacke die Levelziele. Starte im Level Modus, sichere dir im Blocker Modus einen neuen Highscore oder teste den neuen Zeit Modus mit stetig schneller werdender Uhr.',
        'mainMenu.note':
            'Highscores werden wie dein Level-Fortschritt gespeichert. Optionen über das Menü oben rechts öffnen.',
        'button.levelMode': 'Level Modus',
        'button.blockerMode': 'Blocker Modus',
        'button.timeMode': 'Zeit Modus',
        'button.leaderboard': 'Bestenliste',
        'button.shop': 'Shop',
        'button.continue': 'Weiter',
        'button.restart': 'Neu starten',
        'button.home': 'Hauptmenü',
        'button.back': 'Zurück',
        'button.account': 'Konto',
        'button.tutorial': 'Tutorial',
        'levelSelect.title': 'Zuckerwelt',
        'levelSelect.subtitle': 'Wähle ein Level zum Wiederholen oder mache weiter.',
        'levelSelect.selectedTitle': 'Level {level}',
        'levelSelect.meta': '{moves} Züge · Ziel {target} Punkte · {difficulty}',
        'levelSelect.playButton': 'Level starten',
        'levelSelect.playButtonLabel': 'Level {level} starten',
        'levelSelect.goalsTitle': 'Ziele',
        'levelSelect.nodeLabel': 'Level {level}',
        'levelSelect.nodeLockedLabel': 'Level {level} gesperrt',
        'difficulty.easy': 'Leicht',
        'difficulty.normal': 'Normal',
        'difficulty.hard': 'Schwer',
        'difficulty.expert': 'Experte',
        'difficulty.nightmare': 'Albtraum',
        'auth.label': 'Google Login',
        'auth.status.notSignedIn': 'Nicht angemeldet',
        'auth.status.signedIn': 'Angemeldet als {name}',
        'auth.progress.level': 'Fortschritt: Level {level}',
        'auth.progress.blocker': 'Blocker-Modus-Highscore: {score}',
        'auth.progress.time': 'Zeit-Modus-Bestzeit: {time}',
        'auth.progress.coins': 'Zuckermünzen: {coins}',
        'auth.progress.coins.loading': 'Zuckermünzen werden geladen...',
        'auth.progress.loading': 'Fortschritt wird geladen...',
        'auth.progress.blocker.loading': 'Blocker-Highscore wird geladen...',
        'auth.progress.time.loading': 'Zeit-Modus wird geladen...',
        'auth.hint': 'Vor Spielstart bitte anmelden, damit der Fortschritt deinem Konto zugeordnet wird.',
        'auth.googleInfo.prefix': 'Wenn du dich über Google anmeldest, erklärst du dich damit einverstanden, dass dein Name und Spielstand gemäß unserer',
        'auth.googleInfo.link': 'Datenschutzerklärung',
        'auth.googleInfo.suffix': '.',
        'auth.loginButton': 'Mit Google anmelden',
        'auth.error.loginFailed': 'Anmeldung fehlgeschlagen. Bitte erneut versuchen.',
        'auth.error.progressLoad': 'Fortschritt konnte nicht geladen werden. Standard-Level 1 wird verwendet.',
        'auth.error.progressSave': 'Fortschritt konnte nicht gespeichert werden. Bitte Verbindung prüfen.',
        'auth.error.progressDelete': 'Fortschritt konnte nicht gelöscht werden. Bitte versuche es später erneut.',
        'auth.error.accountDelete': 'Account konnte nicht gelöscht werden. Bitte versuche es später erneut.',
        'hud.status.ready': 'Bereit für Kombos!',
        'hud.status.noMoves': 'Keine Züge mehr möglich. Wir mischen!',
        'hud.label.time': 'Zeit',
        'hud.label.moves': 'Züge',
        'hud.label.goals': 'Ziele',
        'hud.status.chooseAdjacent': 'Wähle ein angrenzendes Feld',
        'hud.status.targetAdjacent': 'Ziel muss angrenzend sein',
        'hud.status.powerupActivated': '{powerup} aktiviert!',
        'hud.status.chooseTarget': 'Wähle Ziel für {powerup}',
        'hud.status.powerupCanceled': 'Powerup abgebrochen!',
        'hud.status.powerupUnleashed': '{powerup} entfesselt!',
        'hud.status.switchExecuted': 'Switch ausgeführt!',
        'hud.aria.remainingTime': 'Verbleibende Zeit {current} von {capacity}',
        'hud.aria.scoreBlocker': 'Punktestand {score} von {target}. Bester Lauf: {best}',
        'hud.aria.scoreNormal': 'Punktestand {score} von {target}',
        'hud.goal.remaining': '{description} verbleibend: {remaining}',
        'hud.timeModeHint': 'Überlebt: {survived} · Bestzeit: {best}',
        'hud.blockerHighscore': 'Highscore: {score}',
        'hud.audio.on': 'Audio an',
        'hud.audio.off': 'Audio aus',
        'renderer.comboIncrease': 'Starker Zug!',
        'renderer.comboDecrease': 'Tempo verloren!',
        'renderer.comboNeutral': 'Multiplikator',
        'renderer.points': ' · +{points} Punkte',
        'result.level.winTitle': 'Level {level} geschafft!',
        'result.level.loseTitle': 'Level verloren!',
        'result.level.winNext': 'Weiter geht es mit Level {level}.',
        'result.level.winAll': 'Du hast alle {count} Level gemeistert. Spiele das Finale weiter für Highscores.',
        'result.level.loseText': 'Versuche es direkt noch einmal.',
        'result.blocker.newHighscore': 'Neuer Highscore!',
        'result.blocker.gameOver': 'Keine Züge mehr!',
        'result.blocker.text': 'Punkte: {score}. Bester Lauf: {best}. Gleich noch einmal?',
        'result.time.newBest': 'Neue Bestzeit!',
        'result.time.timeUp': 'Zeit abgelaufen!',
        'result.time.text': 'Überlebt: {survived}. Bestzeit: {best}. Noch einmal?',
        'blocker.status.started': 'Blocker-Modus gestartet. Überlebe so lange wie möglich.',
        'blocker.status.moreHardCandy': 'Mehr harte Bonbons erscheinen!',
        'blocker.status.newHighscore': 'Neuer Highscore!',
        'time.status.started': 'Überlebe so lange wie möglich. Zeit gibt es für Matches und Ziele.',
        'time.status.goalComplete': 'Ziel geschafft! +{seconds}s',
        'leaderboard.lead': 'Übersicht',
        'leaderboard.title': 'Bestenliste',
        'leaderboard.back': 'Zurück zum Menü',
        'leaderboard.mode.level': 'Level-Modus',
        'leaderboard.mode.blocker': 'Blocker-Modus',
        'leaderboard.mode.time': 'Zeit-Modus',
        'leaderboard.scope.global': 'Global',
        'leaderboard.scope.personal': 'Persönlich',
        'leaderboard.scope.label': 'Bereich',
        'leaderboard.loginRequired': 'Bitte anmelden, um persönliche Ergebnisse zu sehen.',
        'leaderboard.error.loadFailed': 'Bestenliste konnte nicht geladen werden.',
        'leaderboard.loading': 'Bestenliste wird geladen...',
        'leaderboard.empty': 'Keine Einträge vorhanden.',
        'leaderboard.metric.level': 'Erreichtes Level',
        'leaderboard.metric.time': 'Überlebenszeit',
        'leaderboard.metric.blocker': 'Blocker-Score',
        'leaderboard.entry.level': 'Level {level}',
        'leaderboard.entry.points': '{points} Punkte',
        'leaderboard.subtitle.countOne': '{count} Eintrag',
        'leaderboard.subtitle.countOther': '{count} Einträge',
        'leaderboard.subtitleTemplate': '{mode} → {scope} → {countLabel}',
        'leaderboard.localPlayer': 'Du',
        'account.title': 'Mein Konto',
        'account.field.name': 'Name',
        'account.status.google': 'Google-Konto',
        'account.status.guest': 'Gastprofil',
        'account.guestDefaultName': 'Gast',
        'account.name.saveButton': 'Name speichern',
        'account.name.saved': 'Name gespeichert',
        'account.name.error.empty': 'Bitte gib einen Namen ein.',
        'account.name.error.generic': 'Änderungen konnten nicht gespeichert werden. Versuche es später erneut.',
        'account.logoutGoogle': 'Abmelden von Google',
        'account.deleteAccount': 'Account löschen',
        'account.deleteAccount.confirm': 'Möchtest du wirklich dein Google-Konto und alle gespeicherten Fortschritte löschen?',
        'account.deleteAccount.confirmButton': 'Account löschen',
        'powerup.shuffle.label': 'Mischen',
        'powerup.shuffle.description': 'Alle Bonbons neu anordnen',
        'powerup.switch.label': 'Switch',
        'powerup.switch.description': 'Tausche zwei benachbarte Felder ohne Match',
        'powerup.bomb.label': 'Bombe',
        'powerup.bomb.description': 'Sprengt ein 4×4-Feld deiner Wahl',
        'shop.title': 'Zuckerladen',
        'shop.lead': 'Gib Zuckermünzen für taktische Vorteile aus.',
        'shop.count': 'Besessen: {count}/{max}',
        'shop.price': 'Preis: {price} Zuckermünzen',
        'shop.priceMaxed': 'Maximal erreicht',
        'shop.button.buy': 'Kaufen',
        'shop.feedback.insufficient': 'Nicht genug Zuckermünzen.',
        'shop.feedback.maxed': 'Du besitzt bereits alle Slots für dieses Powerup.',
        'tutorial.title': 'Candy Guide',
        'tutorial.lead': 'Lerne die Grundlagen zu Boostern, Matches und Spezialfeldern.',
        'tutorial.section.boosters': 'Booster',
        'tutorial.section.matches': 'Matches',
        'tutorial.section.mechanics': 'Spielmechanik',
        'tutorial.section.obstacles': 'Hindernisse',
        'tutorial.section.modes': 'Modi',
        'tutorial.boosters.lead': 'Im Shop gibt es drei taktische Powerups, die du im Level einsetzen kannst.',
        'tutorial.matches.lead':
            'Bomben werden aktiviert, indem du die richtige Farbe matchst. Es gibt 5 verschiedene Farben und das Match muss die gleiche Farbe haben.',
        'tutorial.matches.threeTitle': 'Match 3',
        'tutorial.matches.threeText': 'Räume die Bonbons ab und sammle Punkte.',
        'tutorial.matches.fourTitle': 'Match 4',
        'tutorial.matches.fourText': 'Erzeugt eine Linienbombe.',
        'tutorial.matches.fiveTitle': 'Match 5',
        'tutorial.matches.fiveText':
            'Erzeugt eine große Explosionsbombe. Eine Match-5-Bombe wird durch Anklicken aktiviert.',
        'tutorial.matches.ltTitle': 'L oder T',
        'tutorial.matches.ltText': 'Erzeugt eine mittlere Explosionsbombe.',
        'tutorial.matches.squareTitle': 'Quadrat (2x2)',
        'tutorial.matches.squareText': 'Erzeugt eine kleine Explosionsbombe.',
        'tutorial.mechanics.multiplierText':
            'Der Punkte-Multiplikator steigt nach starken Zügen, fällt nach schwachen oder leeren Zügen und gilt für jeden Punkt.',
        'tutorial.obstacles.hardTitle': 'Harte Bonbons',
        'tutorial.obstacles.hardText': 'Benachbarte Matches knacken sie, bevor sie entfernt werden.',
        'tutorial.obstacles.chestTitle': 'Zuckerkisten',
        'tutorial.obstacles.chestText':
            'Benachbarte Matches knacken sie, bis sie in Zuckermünzen platzen. Es braucht 4 benachbarte Matches, um eine Kiste zu sprengen.',
        'tutorial.obstacles.generatorTitle': 'Blocker-Generatoren',
        'tutorial.obstacles.generatorText': 'Alle paar Matches erzeugen sie in der Nähe neue harte Bonbons.',
        'tutorial.modes.levelTitle': 'Level Modus',
        'tutorial.modes.levelText':
            'Erfülle Ziele mit begrenzten Zügen. Schwierigkeitsgrade: Easy, Normal, Hard, Expert, Nightmare.',
        'tutorial.modes.blockerTitle': 'Blocker Modus',
        'tutorial.modes.blockerText': 'Überlebe, während harte Bonbons sich ausbreiten, und jage einen Highscore.',
        'tutorial.modes.timeTitle': 'Zeit Modus',
        'tutorial.modes.timeText': 'Schlage die Uhr, während sie schneller wird; Matches geben Zeit.',
        'goal.destroyColor': 'Zerstöre {target} {color} Steine',
        'goal.activateBooster': 'Aktiviere {target} {booster}',
        'color.red': 'rote',
        'color.amber': 'gelbe',
        'color.blue': 'blaue',
        'color.purple': 'violette',
        'color.green': 'grüne',
        'booster.LINE': 'Linienbomben',
        'booster.BURST_SMALL': 'kleine Bomben',
        'booster.BURST_MEDIUM': 'mittlere Bomben',
        'booster.BURST_LARGE': 'große Bomben'
    }
} as const;

type TranslationKey = keyof typeof TRANSLATIONS['en'];

const listeners = new Set<(locale: Locale) => void>();

let currentLocale: Locale = 'en';

function formatTranslation(template: string, params?: TranslationParams): string {
    if (!params) {
        return template;
    }
    return template.replace(/\{(\w+)\}/g, (_, key) => {
        const value = params[key];
        return value !== undefined ? String(value) : '';
    });
}

function t(key: TranslationKey, params?: TranslationParams): string {
    const localized = TRANSLATIONS[currentLocale][key] ?? TRANSLATIONS['en'][key];
    return formatTranslation(localized, params);
}

function translateDocument(root: ParentNode = document): void {
    const elements = root.querySelectorAll<HTMLElement>('[data-i18n-key]');
    elements.forEach((element) => {
        const key = element.getAttribute('data-i18n-key') as TranslationKey | null;
        if (!key) return;
        element.textContent = t(key);
    });
}

function setLocale(locale: Locale): void {
    if (locale === currentLocale) return;
    currentLocale = locale;
    document.documentElement.lang = locale;
    translateDocument();
    listeners.forEach((listener) => listener(locale));
}

function getLocale(): Locale {
    return currentLocale;
}

function onLocaleChange(handler: (locale: Locale) => void): () => void {
    handler(currentLocale);
    listeners.add(handler);
    return () => {
        listeners.delete(handler);
    };
}

export { Locale, TranslationKey, t, setLocale, getLocale, onLocaleChange, translateDocument };
